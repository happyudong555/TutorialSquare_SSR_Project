<<<<<<< HEAD
<<<<<<< HEAD
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
=======
'use strict';
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
'use strict';
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

Object.defineProperty(exports, "__esModule", {
  value: true
});
<<<<<<< HEAD
<<<<<<< HEAD
exports.default = void 0;

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

var _keys = _interopRequireDefault(require("@babel/runtime/core-js/object/keys"));

require("event-source-polyfill");

var _clientAutoConnectFalseOverlayFalseReloadTrue = _interopRequireDefault(require("webpack-hot-middleware/client?autoConnect=false&overlay=false&reload=true"));

var _router = _interopRequireDefault(require("../lib/router"));

var _window = window,
    assetPrefix = _window.__NEXT_DATA__.assetPrefix;

var _default = function _default() {
  _clientAutoConnectFalseOverlayFalseReloadTrue.default.setOptionsAndConnect({
    path: "".concat(assetPrefix, "/_next/webpack-hmr")
  });

  var handlers = {
    reload: function reload(route) {
      if (route === '/_error') {
        var _arr = (0, _keys.default)(_router.default.components);

        for (var _i = 0; _i < _arr.length; _i++) {
          var r = _arr[_i];
          var err = _router.default.components[r].err;

          if (err) {
            // reload all error routes
            // which are expected to be errors of '/_error' routes
            _router.default.reload(r);
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _keys = require('babel-runtime/core-js/object/keys');

var _keys2 = _interopRequireDefault(_keys);

var _getIterator2 = require('babel-runtime/core-js/get-iterator');

var _getIterator3 = _interopRequireDefault(_getIterator2);

var _webpackHmr = require('webpack-hot-middleware/client?overlay=false&reload=true&path=/_next/webpack-hmr');

var _webpackHmr2 = _interopRequireDefault(_webpackHmr);

var _router = require('../lib/router');

var _router2 = _interopRequireDefault(_router);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function () {
  var handlers = {
    reload: function reload(route) {
      if (route === '/_error') {
        var _iteratorNormalCompletion = true;
        var _didIteratorError = false;
        var _iteratorError = undefined;

        try {
          for (var _iterator = (0, _getIterator3.default)((0, _keys2.default)(_router2.default.components)), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            var r = _step.value;
            var err = _router2.default.components[r].err;

            if (err) {
              // reload all error routes
              // which are expected to be errors of '/_error' routes
              _router2.default.reload(r);
            }
          }
        } catch (err) {
          _didIteratorError = true;
          _iteratorError = err;
        } finally {
          try {
            if (!_iteratorNormalCompletion && _iterator.return) {
              _iterator.return();
            }
          } finally {
            if (_didIteratorError) {
              throw _iteratorError;
            }
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
          }
        }

        return;
<<<<<<< HEAD
<<<<<<< HEAD
      } // If the App component changes we have to reload the current route


      if (route === '/_app') {
        _router.default.reload(_router.default.route);

        return;
      } // Since _document is server only we need to reload the full page when it changes.

=======
      }
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      }
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

      if (route === '/_document') {
        window.location.reload();
        return;
      }

<<<<<<< HEAD
<<<<<<< HEAD
      _router.default.reload(route);
    },
    change: function change(route) {
      // If the App component changes we have to reload the current route
      if (route === '/_app') {
        _router.default.reload(_router.default.route);

        return;
      } // Since _document is server only we need to reload the full page when it changes.


=======
      _router2.default.reload(route);
    },
    change: function change(route) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      _router2.default.reload(route);
    },
    change: function change(route) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
      if (route === '/_document') {
        window.location.reload();
        return;
      }

<<<<<<< HEAD
<<<<<<< HEAD
      var _ref = _router.default.components[route] || {},
=======
      var _ref = _router2.default.components[route] || {},
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      var _ref = _router2.default.components[route] || {},
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
          err = _ref.err,
          Component = _ref.Component;

      if (err) {
        // reload to recover from runtime errors
<<<<<<< HEAD
<<<<<<< HEAD
        _router.default.reload(route);
      }

      if (_router.default.route !== route) {
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
        _router2.default.reload(route);
      }

      if (_router2.default.route !== route) {
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
        // If this is a not a change for a currently viewing page.
        // We don't need to worry about it.
        return;
      }

      if (!Component) {
        // This only happens when we create a new page without a default export.
        // If you removed a default export from a exising viewing page, this has no effect.
<<<<<<< HEAD
<<<<<<< HEAD
        console.log("Hard reloading due to no default component in page: ".concat(route));
=======
        console.log('Hard reloading due to no default component in page: ' + route);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
        console.log('Hard reloading due to no default component in page: ' + route);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
        window.location.reload();
      }
    }
  };

<<<<<<< HEAD
<<<<<<< HEAD
  _clientAutoConnectFalseOverlayFalseReloadTrue.default.subscribe(function (obj) {
    var fn = handlers[obj.action];

    if (fn) {
      var data = obj.data || [];
      fn.apply(void 0, (0, _toConsumableArray2.default)(data));
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
  _webpackHmr2.default.subscribe(function (obj) {
    var fn = handlers[obj.action];
    if (fn) {
      var data = obj.data || [];
      fn.apply(undefined, (0, _toConsumableArray3.default)(data));
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
    } else {
      throw new Error('Unexpected action ' + obj.action);
    }
  });
<<<<<<< HEAD
<<<<<<< HEAD
};

exports.default = _default;
=======
};
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
};
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
