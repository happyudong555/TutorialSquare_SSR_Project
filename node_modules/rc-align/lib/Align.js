'use strict';

<<<<<<< HEAD
<<<<<<< HEAD
exports.__esModule = true;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);
=======
Object.defineProperty(exports, "__esModule", {
  value: true
});
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
Object.defineProperty(exports, "__esModule", {
  value: true
});
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _domAlign = require('dom-align');

var _domAlign2 = _interopRequireDefault(_domAlign);

var _addEventListener = require('rc-util/lib/Dom/addEventListener');

var _addEventListener2 = _interopRequireDefault(_addEventListener);

<<<<<<< HEAD
<<<<<<< HEAD
var _shallowequal = require('shallowequal');

var _shallowequal2 = _interopRequireDefault(_shallowequal);

=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
var _isWindow = require('./isWindow');

var _isWindow2 = _interopRequireDefault(_isWindow);

<<<<<<< HEAD
<<<<<<< HEAD
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

function buffer(fn, ms) {
  var timer = void 0;

  function clear() {
    if (timer) {
      clearTimeout(timer);
      timer = null;
    }
  }

  function bufferFn() {
    clear();
    timer = setTimeout(fn, ms);
  }

  bufferFn.clear = clear;

  return bufferFn;
}

var Align = function (_Component) {
<<<<<<< HEAD
<<<<<<< HEAD
  (0, _inherits3['default'])(Align, _Component);
=======
  _inherits(Align, _Component);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
  _inherits(Align, _Component);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

  function Align() {
    var _temp, _this, _ret;

<<<<<<< HEAD
<<<<<<< HEAD
    (0, _classCallCheck3['default'])(this, Align);
=======
    _classCallCheck(this, Align);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
    _classCallCheck(this, Align);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

<<<<<<< HEAD
<<<<<<< HEAD
    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3['default'])(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.forceAlign = function () {
      var props = _this.props;
      if (!props.disabled) {
        var source = _reactDom2['default'].findDOMNode(_this);
        props.onAlign(source, (0, _domAlign2['default'])(source, props.target(), props.align));
      }
    }, _temp), (0, _possibleConstructorReturn3['default'])(_this, _ret);
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.forceAlign = function () {
      var props = _this.props;
      if (!props.disabled) {
        var source = _reactDom2["default"].findDOMNode(_this);
        props.onAlign(source, (0, _domAlign2["default"])(source, props.target(), props.align));
      }
    }, _temp), _possibleConstructorReturn(_this, _ret);
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
  }

  Align.prototype.componentDidMount = function componentDidMount() {
    var props = this.props;
    // if parent ref not attached .... use document.getElementById
    this.forceAlign();
    if (!props.disabled && props.monitorWindowResize) {
      this.startMonitorWindowResize();
    }
  };

  Align.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {
    var reAlign = false;
    var props = this.props;

    if (!props.disabled) {
<<<<<<< HEAD
<<<<<<< HEAD
      if (prevProps.disabled || !(0, _shallowequal2['default'])(prevProps.align, props.align)) {
=======
      if (prevProps.disabled || prevProps.align !== props.align) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      if (prevProps.disabled || prevProps.align !== props.align) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
        reAlign = true;
      } else {
        var lastTarget = prevProps.target();
        var currentTarget = props.target();
<<<<<<< HEAD
<<<<<<< HEAD
        if ((0, _isWindow2['default'])(lastTarget) && (0, _isWindow2['default'])(currentTarget)) {
=======
        if ((0, _isWindow2["default"])(lastTarget) && (0, _isWindow2["default"])(currentTarget)) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
        if ((0, _isWindow2["default"])(lastTarget) && (0, _isWindow2["default"])(currentTarget)) {
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
          reAlign = false;
        } else if (lastTarget !== currentTarget) {
          reAlign = true;
        }
      }
    }

    if (reAlign) {
      this.forceAlign();
    }

    if (props.monitorWindowResize && !props.disabled) {
      this.startMonitorWindowResize();
    } else {
      this.stopMonitorWindowResize();
    }
  };

  Align.prototype.componentWillUnmount = function componentWillUnmount() {
    this.stopMonitorWindowResize();
  };

  Align.prototype.startMonitorWindowResize = function startMonitorWindowResize() {
    if (!this.resizeHandler) {
      this.bufferMonitor = buffer(this.forceAlign, this.props.monitorBufferTime);
<<<<<<< HEAD
<<<<<<< HEAD
      this.resizeHandler = (0, _addEventListener2['default'])(window, 'resize', this.bufferMonitor);
=======
      this.resizeHandler = (0, _addEventListener2["default"])(window, 'resize', this.bufferMonitor);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      this.resizeHandler = (0, _addEventListener2["default"])(window, 'resize', this.bufferMonitor);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
    }
  };

  Align.prototype.stopMonitorWindowResize = function stopMonitorWindowResize() {
    if (this.resizeHandler) {
      this.bufferMonitor.clear();
      this.resizeHandler.remove();
      this.resizeHandler = null;
    }
  };

  Align.prototype.render = function render() {
    var _props = this.props,
        childrenProps = _props.childrenProps,
        children = _props.children;

<<<<<<< HEAD
<<<<<<< HEAD
    var child = _react2['default'].Children.only(children);
=======
    var child = _react2["default"].Children.only(children);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
    var child = _react2["default"].Children.only(children);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
    if (childrenProps) {
      var newProps = {};
      for (var prop in childrenProps) {
        if (childrenProps.hasOwnProperty(prop)) {
          newProps[prop] = this.props[childrenProps[prop]];
        }
      }
<<<<<<< HEAD
<<<<<<< HEAD
      return _react2['default'].cloneElement(child, newProps);
=======
      return _react2["default"].cloneElement(child, newProps);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
      return _react2["default"].cloneElement(child, newProps);
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
    }
    return child;
  };

  return Align;
}(_react.Component);

Align.propTypes = {
<<<<<<< HEAD
<<<<<<< HEAD
  childrenProps: _propTypes2['default'].object,
  align: _propTypes2['default'].object.isRequired,
  target: _propTypes2['default'].func,
  onAlign: _propTypes2['default'].func,
  monitorBufferTime: _propTypes2['default'].number,
  monitorWindowResize: _propTypes2['default'].bool,
  disabled: _propTypes2['default'].bool,
  children: _propTypes2['default'].any
=======
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
  childrenProps: _propTypes2["default"].object,
  align: _propTypes2["default"].object.isRequired,
  target: _propTypes2["default"].func,
  onAlign: _propTypes2["default"].func,
  monitorBufferTime: _propTypes2["default"].number,
  monitorWindowResize: _propTypes2["default"].bool,
  disabled: _propTypes2["default"].bool,
  children: _propTypes2["default"].any
<<<<<<< HEAD
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
};
Align.defaultProps = {
  target: function target() {
    return window;
  },
  onAlign: function onAlign() {},
  monitorBufferTime: 50,
  monitorWindowResize: false,
  disabled: false
};
<<<<<<< HEAD
<<<<<<< HEAD
exports['default'] = Align;
=======
exports["default"] = Align;
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
=======
exports["default"] = Align;
>>>>>>> 3e7cc9eba236ff5c5205c34bae31be88b995768b
module.exports = exports['default'];